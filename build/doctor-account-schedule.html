<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Speak your mind">
  <title>Speak your mind</title>
  <link rel="icon" type="image/x-icon" href="./favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="./img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./img/favicon/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./img/favicon/apple-touch-icon.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
  <link rel="stylesheet" href="css/style.min.css">

  <style>
    .calendar-wrapper {
      width: 100%;
      margin: 3em auto;
    }

    table {
      clear: both;
      width: 100%;
      border: 1px solid #dcdcff;
      border-radius: 3px;
      border-collapse: collapse;
      color: #444;
    }

    td {
      height: 48px;
      text-align: center;
      vertical-align: middle;
      width: 50px;
    }

    .days td {
      background-color: #c5fdea;
      border-bottom: 1px solid #a3a3a3;
      height: 36px;
    }

    td.not-current {
      color: #c0c0c0;
    }

    td.today {
      font-weight: 700;
      color: #28283b;
      font-size: 1.5em;
    }

    thead td {
      border: none;
      color: #28283b;
      text-transform: uppercase;
      font-size: 1.5em;
    }

    td.past {
      background-color: #eaeaea;
    }

    td.past label {
      display: none;
    }

    td.check,
    td.hours {
      width: 130px;
      height: 64px;
      border-bottom: 1px solid #a3a3a3;
    }

    .send-btn {
      position: absolute;
      top: 0;
      right: 0;
      padding: 10px 20px;
    }
  </style>
</head>

<body>
  <div class="wrapper internal user-logged user-logged-doctor">
    <header class="header">
      <div class="container">
        <div class="header__logo">
          <div class="header__logo-wrapper">
            <svg width="196" height="24" fill="currentColor">
              <use xlink:href="./img/sprite.svg#logo"></use>
            </svg>
          </div>
        </div>
        <nav class="header__nav nav">
          <div class="nav__wrapper">
            <ul class="nav__list">
              <li class="nav__item nav__item--psychologists">
                <a class="nav__link" data-translate="nav_doc" href="doctor-landing.html"></a>
              </li>
              <!-- <li class="nav__item nav__item--businnes">
                <a class="nav__link href="businnes-landing.html" data-translate="nav_comp"></a>
              </li> -->
              <li class="nav__item">
                <a class="nav__link" href="faq.html">FAQ</a>
              </li>
            </ul>
          </div>
        </nav>
        <div class="header__lang-switcher lang-switcher">
          <button class="lang-switcher__btn js-dropdown-trigger" data-id="#lang-switcher">
            <span data-translate="current_language"></span>
            <svg width="10" height="10" fill="currentColor">
              <use xlink:href="./img/sprite.svg#dropdown"></use>
            </svg>
          </button>
          <ul class="lang-switcher__list list-reset" id="lang-switcher">
            <!-- <li class="lang-switcher__item">
              <a href="#" data-lang="hu">Hu</a>
            </li> -->
            <li class="lang-switcher__item">
              <a href="#" data-lang="en">En</a>
            </li>
            <li class="lang-switcher__item">
              <a href="#" data-lang="ru">Ru</a>
            </li>
          </ul>
        </div>
        <div class="header__unlogged unlogged">
          <a class="unlogged__login-btn btn btn--white" data-translate="header_login_btn"></a>
          <a href="user-signup-start.html" class="unlogged__login-btn btn" data-translate="header_signup_btn"></a>
        </div>
        <div class="header__logged logged">
          <div class="logged__wrapper">
            <div class="logged__user-thumb">
              <img src="./img/content/user-thumb.png" width="24" height="24" alt="">
            </div>
            <button class="logged__btn js-dropdown-trigger" data-id="#logged-menu">
              <span class="logged__username">Александр</span>
              <svg width="10" height="10" fill="currentColor">
                <use xlink:href="./img/sprite.svg#dropdown"></use>
              </svg>
            </button>
            <ul class="logged__menu-list list-reset" id="logged-menu">
              <li class="logged__menu-item">
                <a href="#" data-translate="logout_btn">Выйти</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </header>
    <main>
      <section class="doctor-account">
        <div class="container">
          <div class="doctor-account__wrapper">
            <div class="doctor-account__left-col">
              <div class="doctor-account__nav">
                <div class="user-account__nav-logo">
                  <img src="./img/svg/nav-logo.svg" width="72" height="72" alt="Speak your mind.">
                </div>
                <a href="doctor-account-sessions.html" class="doctor-account__nav-link">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#doc-sessions"></use>
                  </svg>
                  <span>Сессии</span>
                </a>
                <a href="doctor-account-schedule.html" class="doctor-account__nav-link is-active">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#doc-schedule"></use>
                  </svg>
                  <span>Расписание</span>
                </a>
                <a href="doctor-account-clients.html" class="doctor-account__nav-link">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#doc-clients"></use>
                  </svg>
                  <span>Клиенты</span>
                </a>
                <a href="doctor-account-payments.html" class="doctor-account__nav-link">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#user-payment"></use>
                  </svg>
                  <span>Платежи</span>
                </a>
                <a href="doctor-account-settings.html" class="doctor-account__nav-link">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#user-settings"></use>
                  </svg>
                  <span>Профиль</span>
                </a>
                <a href="/faq.html" class="user-account__nav-link">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#user-help"></use>
                  </svg>
                  <span>Помощь</span>
                </a>
                <a href="doctor-landing.html" class="user-account__nav-link" id="logout-btn">
                  <svg width="25" height="25" fill="currentColor">
                    <use xlink:href="./img/sprite.svg#user-logout"></use>
                  </svg>
                  <span>Выход</span>
                </a>
              </div>
            </div>
            <div class="doctor-account__right-col">
              <div class="doctor-account__schedule schedule">
                <div class="doctor-account__heading">
                  <h2 class="text-40">Расписание</h2>
                  <p>Отметьте, пожалуйста, галочкой то время, когда вы свободны и на которое можно назначать
                    консультации</p>
                  <button type="button" class="send-btn btn" id="send-btn">Сохранить изменения</button>
                  <div class="calendar-wrapper">
                    <button class="btn-current schedule__tab-btn is-active" id="btn-1">Текущая неделя</button>
                    <button class="btn-2 schedule__tab-btn" id="btn-2">2 неделя</button>
                    <button class="btn-3 schedule__tab-btn" id="btn-3">3 неделя</button>
                    <button class="btn-4 schedule__tab-btn" id="btn-4">4 неделя</button>
                    <div class="cal-wrapper">

                      <div id="divCal"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="footer">
      <div class="container">
        <div class="footer__left"></div>
        <div class="footer__copyright">
          <span>&copy; Speak Your Mind 2023</span>
        </div>
      </div>
    </footer>
  </div>

  <div class="modal modal--preload" id="upload-avatar">
    <div class="modal__wrapper">
      <div class="modal__overlay" data-close-modal></div>
      <div class="modal__content modal__content--upload-avatar">
        <button class="modal__close-btn" type="button" aria-label="Закрыть окно." data-close-modal>
          <svg width="32" height="32" fill="currentColor">
            <use xlink:href="./img/sprite.svg#close-modal"></use>
          </svg>
        </button>
        <div class="avatar-upload">
          <h2 class="modal__title text-31">Загрузите фото</h2>
          <form action="" method="post" id="avatar-upload-form">
            <fieldset>
              <label>
                <input type="file" name="avatar" id="avatar">
              </label>
            </fieldset>
            <button type="submit" class="avatar-upload__submit-btn btn">Загрузить фото</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal modal--preload" id="new-card-popup">
    <div class="modal__wrapper">
      <div class="modal__overlay" data-close-modal></div>
      <div class="modal__content modal__content--new-card">
        <button class="modal__close-btn" type="button" aria-label="Закрыть окно." data-close-modal>
          <svg width="32" height="32" fill="currentColor">
            <use xlink:href="./img/sprite.svg#close-modal"></use>
          </svg>
        </button>
        <h2 class="modal__title text-31">Привязать карту</h2>
        <div class="card">
          <div class="card__card-info">
            <form action="" method="post">
              <fieldset>
                <label for="card-owner">
                  <span>Имя владельца карты</span>
                  <input type="text" id="card-owner" placeholder="Имя на лицевой стороне карты">
                </label>
              </fieldset>
              <fieldset>
                <label for="card-number">
                  <span>Номер карты</span>
                  <input type="number" id="card-number" placeholder="x x x x    x x x x    x x x x    x x x x">
                </label>
              </fieldset>
              <fieldset>
                <label for="card-exp">
                  <span>Срок действия</span>
                  <input type="number" id="card-exp" placeholder="m m  /  y y">
                </label>
                <label for="card-cvc">
                  <span>Код CVС</span>
                  <input type="number" id="card-cvc" maxlength="3" placeholder="x x x">
                </label>
              </fieldset>
              <p class="card__permission text-18">
                Добавляя карту вы принимаете <a href="#" data-open-modal data-modal-id="#payment-terms"
                  class="text-green">условия сервиса</a>
              </p>
              <button type="submit" class="card__submit-btn btn">Добавить карту</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal modal--preload" id="payment-terms">
    <div class="modal__wrapper">
      <div class="modal__overlay" data-close-modal></div>
      <div class="modal__content modal__content--new-card">
        <button class="modal__close-btn" type="button" aria-label="Закрыть окно." data-close-modal>
          <svg width="32" height="32" fill="currentColor">
            <use xlink:href="./img/sprite.svg#close-modal"></use>
          </svg>
        </button>
        <h2 class="modal__title text-31">Условия сервиса и автосписания</h2>
        <p class="modal__text text-18"> Пользователю доступна функция безналичной оплаты Видеоконсультаций, в этом
          случае «Speak your mind» действует по поручению соответствующего Психолога с привлечением уполномоченной
          платежной системы и является получателем платежа в качестве агента Психолога (далее – «безналичная оплата»).
        </p>
        <p class="modal__text text-18">«Speak your mind» не гарантирует отсутствия ошибок и сбоев в работе Сервиса в
          отношении предоставления
          возможности безналичной оплаты. Списание денежных средств за Видеоконсультацию осуществляется за 24 часа до
          момента проведения Видеоконсультации, а если Пользователь записался на Видеоконсультацию менее, чем за 24
          часа, то списание осуществляется за 12 часов до Видеоконсультации или в момент записи на Видеоконсультацию, в
          зависимости от того, что наступит ранее. В случае невозможности списания денежных средств за 12 часов до
          проведения Видеоконсультации, Видеоконсультация подлежит отмене.</p>
      </div>
    </div>
  </div>

  <div class="modal modal--preload" id="client-card">
    <div class="modal__wrapper">
      <div class="modal__overlay" data-close-modal></div>
      <div class="modal__content modal__content--client-card client-card">
        <button class="modal__close-btn" type="button" aria-label="Закрыть окно." data-close-modal>
          <svg width="32" height="32" fill="currentColor">
            <use xlink:href="./img/sprite.svg#close-modal"></use>
          </svg>
        </button>
        <p class="client-card__heading">
          <span class="text-31 client-card__username">Ксения</span>
          <span class="text-31 client-card__userid">#663385</span>
        </p>
        <p class="client-card__info">
          <span class="text-20 client-card__info-subhead">Возраст</span>
          <span><span class="text-20 client-card__age">36</span> лет</span>
        </p>
        <p class="client-card__info">
          <span class="text-20 client-card__info-subhead">Сессий</span>
          <span class="text-20 client-card__sessions-amount">11</span>
        </p>
        <p class="client-card__info">
          <span class="text-20 client-card__info-subhead">Следующая сессия</span>
          <span class="text-20 client-card__next-session">05 июля 15:00</span>
        </p>
        <p class="client-card__info">
          <span class="text-20 client-card__info-subhead">Запрос</span>
          <span class="text-20 client-card__next-session">Депрессивные состояния, одиночество, отношения с родителями,
            “не знаю, чем хочу заниматься”</span>
        </p>
        <div class="client-card__btns-wrapper">
          <a href="#" class="client-card__btn client-card__btn--chat btn btn--white">
            <svg width="30" height="22" fill="currentColor">
              <use xlink:href="./img/sprite.svg#chat"></use>
            </svg>
            <span>Чат с клиентом</span>
          </a>
          <a href="#" class="client-card__btn client-card__btn--notes btn btn--white">Заметки</a>
        </div>
      </div>
    </div>
  </div>

  <div class="modal modal--preload" id="doctor-reschedule">
    <div class="modal__wrapper">
      <div class="modal__overlay" data-close-modal></div>
      <div class="modal__content modal__content--doctor-reschedule doctor-reschedule">
        <button class="modal__close-btn" type="button" aria-label="Закрыть окно." data-close-modal>
          <svg width="32" height="32" fill="currentColor">
            <use xlink:href="./img/sprite.svg#close-modal"></use>
          </svg>
        </button>
        <h2 class="text-25 doctor__title">Мое расписание</h2>
        <form action="" method="post">
          <div class="doctor__day-wrapper">
            <p class="doctor__day">
              <time datetime="2024-07-05">5 июля</time>
              <span>, среда</span>
            </p>
            <fieldset>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">07:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">08:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">09:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">10:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">11:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">12:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">13:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">14:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">15:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">16:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">17:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">18:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">19:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">20:00</span>
              </label>
            </fieldset>
          </div>
          <div class="doctor__day-wrapper">
            <p class="doctor__day">
              <time datetime="2024-07-06">6 июля</time>
              <span>, четверг</span>
            </p>
            <fieldset>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">07:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">08:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">09:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">10:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">11:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">12:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">13:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">14:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">15:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">16:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">17:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">18:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">19:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">20:00</span>
              </label>
            </fieldset>
          </div>
          <div class="doctor__day-wrapper">
            <p class="doctor__day">
              <time datetime="2024-07-07">7 июля</time>
              <span>, пятница</span>
            </p>
            <fieldset>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">07:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">08:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">09:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">10:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">11:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">12:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">13:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">14:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">15:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">16:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">17:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">18:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">19:00</span>
              </label>
              <label>
                <input type="radio" name="appointment-time" value="">
                <span class="time-value">20:00</span>
              </label>
            </fieldset>
          </div>
          <button type="button" class="doctor__expand-btn">
            <span>Показать еще 3 дня</span>
            <svg width="10" height="10" fill="currentColor">
              <use xlink:href="./img/sprite.svg#dropdown-green"></use>
            </svg>
          </button>
          <button type="submit" class="doctor__submit-btn btn">
            <span class="doctor__submit-text">Выбрать&nbsp;</span>
          </button>
        </form>
      </div>
    </div>
  </div>

  <script>
    class Calendar {
      //Сохраняем идентификатор div
      divId;

      // Дни недели с понедельника
      DaysOfWeek = ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'
      ];

      //Устанавливаем текущий месяц, год
      d = new Date();

      currMonth = this.d.getMonth('9');
      currYear = this.d.getFullYear('22');
      currDay = this.d.getDate('3');

      constructor(divId) {
        this.divId = divId;
      }

      // Показать текущий месяц/неделю
      showcurr() {
        this.showWeek(this.currYear, this.currMonth);
      };

      // Показать неделю
      showWeek(y, m, date = this.currDay) {

        let curr = new Date(y, m, date);

        let week = []

        //
        for (let i = 1; i <= 7; i++) {
          const currDay = curr.getDay() ? curr.getDay() : 7;
          let first = curr.getDate() - currDay + i + 1;
          let day = new Date(curr.setDate(first)).toISOString().slice(0, 10)
          week.push(day)
        }

        let html = '<table>';

        html += '<tr class="days">';
        html += '<td class="empty"</td>';
        for (let i = 0; i < week.length; i++) {
          const day = new Date(week[i])
          html += `<td class="date" x-time="${day}">${this.DaysOfWeek[i]},  ${day.getDate()}</td>`;
        }
        html += '</tr>';
        // добавлять checkbox и др
        for (let i = 0; i < 24; i++) {
          html += '<tr class="slots">'
          html += '<td class="hours">'
          if (i < 10) {
            html += `0${i}:00`;
          } else {
            html += `${i}:00`;
          }
          html += '</td>'
          for (let j = 0; j < 7; j++) {
            const tdDay = new Date(week[j]).getDate();
            const tdMonth = new Date(week[j]).getMonth() + 1;
            const tdyear = new Date(week[j]).getFullYear();
            html += '<td class="check">'
            html += `<label><input type="checkbox" value="`
            if (tdDay < 10) {
              html += `0${tdDay}-`
            } else {
              html += `${tdDay}-`
            }
            if (tdMonth < 10) {
              html += `0${tdMonth}-`
            } else {
              html += `${tdMonth}-`
            }
            html += `${tdyear}`
            html += ' ';
            if (i < 10) {
              html += `0${i}:00`;
            } else {
              html += `${i}:00`;
            }
            html += `" name="schedule"></label>`
            html += '</td>'
          }
          html += '</tr>'
        }

        // Конец таблицы
        html += '</table>';

        // Записываем HTML в div
        document.getElementById(this.divId).innerHTML = html;
      };

      showWeek2() {
        let nextDate = new Date(this.currYear, this.currMonth, this.currDay);
        nextDate.setDate(nextDate.getDate() + 7);

        this.showWeek(nextDate.getFullYear(), nextDate.getMonth(), nextDate.getDate());
      };

      showWeek3() {
        let nextDate = new Date(this.currYear, this.currMonth, this.currDay);
        nextDate.setDate(nextDate.getDate() + 14);

        this.showWeek(nextDate.getFullYear(), nextDate.getMonth(), nextDate.getDate());
      };

      showWeek4() {
        let nextDate = new Date(this.currYear, this.currMonth, this.currDay);
        nextDate.setDate(nextDate.getDate() + 21);

        this.showWeek(nextDate.getFullYear(), nextDate.getMonth(), nextDate.getDate());
      };
    }

    // функция для текста кнопок

    function getWeekRange(weekOffset) {
      const today = new Date();
      const dayOfWeek = today.getDay(); // Получаем день недели (0 - воскресенье, 1 - понедельник, ..., 6 - суббота)

      // Вычисляем разницу в днях до понедельника (1) и воскресенья (0)
      const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek; // Если сегодня воскресенье, то -6, иначе 1 - dayOfWeek
      const sundayOffset = dayOfWeek === 0 ? 0 : 7 - dayOfWeek; // Если сегодня воскресенье, то 0, иначе 7 - dayOfWeek

      // Получаем даты понедельника и воскресенья текущей недели
      const monday = new Date(today);
      monday.setDate(today.getDate() + mondayOffset + (weekOffset * 7));

      const sunday = new Date(today);
      sunday.setDate(today.getDate() + sundayOffset + (weekOffset * 7));

      // Форматируем даты в нужный формат "DD.MM"
      const formatDate = (date) => {
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0'); // Месяцы начинаются с 0
        return `${day}.${month}`;
      };

      return `${formatDate(monday)} - ${formatDate(sunday)}`;
    }

    // Устанавливаем текст для кнопок

    function setButtons() {
      document.querySelector('#btn-2').textContent = getWeekRange(1);
      document.querySelector('#btn-3').textContent = getWeekRange(2);
      document.querySelector('#btn-4').textContent = getWeekRange(3);
    }

    function clearBtnClasses() {
      const btns = document.querySelectorAll('.schedule__tab-btn');

      btns.forEach((btn) => {
        if (btn.classList.contains('is-active')) {
          btn.classList.remove('is-active');
        }
      })
    }

    // получение расписания с бэкенда

    function loadDataFromBackend() {
      const token = localStorage.getItem('token');

      const dataToSend = JSON.stringify({
        session_token: token,
        schedule: [],
        timezone: ''
      });

      if (token) {
        // URL для получения данных пользователя
        const url = 'http://63.250.47.203:8000/doctor_schedule';

        // Отправка запроса на сервер
        fetch(url, {
          // mode: 'no-cors',
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: dataToSend
        })
          .then(response => {
            if (!response.ok) {
              throw new Error('Сеть не в порядке');
            }
            return response.json();
          })
          .then(data => {
            // Обновляем dataObject и localStorage на основе полученных данных
            if (data.schedule) {
              console.log('Расписание:', data);
              dataObject = data.schedule; // Предполагается, что данные расписания находятся в поле schedule
              saveDataToLocalStorage(); // Сохраняем обновленные данные в localStorage
              restoreCheckboxState(); // Обновляем состояние чекбоксов на странице
            }
          })
          .catch(error => {
            console.error('Ошибка при получении данных:', error);
          });
      } else {
        console.log('Токен не найден. Пожалуйста, войдите в систему.');
      }
    }

    function checkPrevious() {
      const days = document.querySelectorAll('.date');
      const current = new Date();
      current.setDate(current.getDate() - 1);
      const currentParsed = Date.parse(current);
      days.forEach((day) => {
        const date = Date.parse(day.getAttribute('x-time'));
        if (date <= currentParsed) {
          day.classList.add('previous');
        }
      })
    }

    function setPreviousStyles() {
      const dates = document.querySelectorAll('.date');
      const slots = document.querySelectorAll('.slots');
      for (let i = 0; i < dates.length; i++) {
        if (dates[i].classList.contains('previous')) {
          slots.forEach((slot) => {
            const cells = slot.querySelectorAll('.check');
            cells[i].classList.add('past');
          });
        }
      }
    }

    function updateCal() {
      const inputs = document.querySelectorAll('input[type="checkbox"]');

      if (!inputs.length) {
        setTimeout(() => {
          updateCal();
        }, 500);
      }
      checkPrevious();
      setPreviousStyles();
      showValues();
      restoreCheckboxState();
      setButtons();
    }

    // сохраняем данные в массив
    let dataObject = [];

    // Проверяем, есть ли сохраненные данные в localStorage
    if (localStorage.getItem('checkboxData')) {
      const storedData = JSON.parse(localStorage.getItem('checkboxData'));
      if (Array.isArray(storedData)) {
        dataObject = storedData;
      }
    }

    function saveDataToLocalStorage() {
      localStorage.setItem('checkboxData', JSON.stringify(dataObject));
    }

    function updateDataObject(checkbox) {

      const formattedTime = checkbox.value;

      if (checkbox.checked) {
        if (!dataObject.includes(formattedTime)) {
          dataObject.push(formattedTime);
        }
      } else {
        const index = dataObject.indexOf(formattedTime);
        if (index !== -1) {
          dataObject.splice(index, 1);
        }
      }

      saveDataToLocalStorage();
    }

    function restoreCheckboxState() {
      const inputs = document.querySelectorAll('input[type="checkbox"]');

      inputs.forEach((input) => {
        const formattedTime = input.value;

        if (dataObject.includes(formattedTime)) {
          input.checked = true;
        }
      });
    }

    function showValues() {
      const inputs = document.querySelectorAll('input[type="checkbox"]');

      inputs.forEach((input) => {
        input.addEventListener('change', function () {
          updateDataObject(this);
        });
      });
    }

    function sendDataToBackend() {
      var x = new Date();
      var currentTimeZoneOffsetInHours = String(x.getTimezoneOffset() / 60);

      const token = localStorage.getItem('token');

      const dataToSend = JSON.stringify({
        session_token: token,
        schedule: dataObject,
        timezone: currentTimeZoneOffsetInHours
      });

      fetch('http://63.250.47.203:8000/doctor_schedule', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: dataToSend
      })
        .then(response => {
          // Проверка, если сервер вернул успешный ответ
          if (!response.ok) {
            throw new Error('Ошибка сети: ' + response.status);
          }
          return response.json(); // Предполагается, что сервер возвращает JSON
        })
        .then(data => {
          // Обработка ответа от сервера
          console.log(data); // Выводим данные в консоль для отладки
        })
        .catch(error => {
          console.error('Произошла ошибка:', error);
        });
    }

    const saveButton = document.getElementById('send-btn');
    saveButton.addEventListener('click', function () {
      sendDataToBackend();
    });

    window.addEventListener('load', function () {

      // Начать календарь
      var c = new Calendar("divCal");
      c.showcurr();
      updateCal();

      // переключение кнопок

      // Показать текущую неделю
      document.querySelector("#btn-1").addEventListener("click", function () {
        c.showcurr();
        updateCal();
        clearBtnClasses()
        this.classList.add('is-active');
      });

      // Показать 2 неделю
      document.querySelector("#btn-2").addEventListener("click", function () {
        c.showWeek2();
        updateCal();
        clearBtnClasses();
        this.classList.add('is-active');
      });

      // Показать 3 неделю
      document.querySelector("#btn-3").addEventListener("click", function () {
        c.showWeek3();
        updateCal();
        clearBtnClasses();
        this.classList.add('is-active');
      });

      // Показать 4 неделю
      document.querySelector("#btn-4").addEventListener("click", function () {
        c.showWeek4();
        updateCal();
        clearBtnClasses();
        this.classList.add('is-active');
      });

      loadDataFromBackend();
      showValues();

      // сюда добавить гет запрос на бэкенд с получением данных - вызов функции
      // добавить loader
    });

  </script>

  <script src="js/vendor.min.js"></script>
  <script src="js/main.min.js"></script>
</body>

</html>
